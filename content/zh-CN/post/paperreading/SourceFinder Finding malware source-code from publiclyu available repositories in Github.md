---
title: "SourceFinder Finding Malware Source Code From Publiclyu Available Repositories in Github"
date: 2021-10-15T08:28:59+08:00
tags : [
    "论文阅读笔记",
]
categories : [
    "论文阅读笔记",
]
series : []
aliases : []
draft: false
---

# 目录： <!-- omit in toc -->
- [1. 综述翻译](#1-综述翻译)
  - [1.1 发表于](#11-发表于)
- [2. Tag](#2-tag)
- [3. 任务描述](#3-任务描述)
- [4. 方法](#4-方法)
- [5. 解决了什么问题（贡献）](#5-解决了什么问题贡献)
- [6. 实验结果](#6-实验结果)
- [7. 如何想到该方法](#7-如何想到该方法)
- [8. 我能否想到该方法](#8-我能否想到该方法)
- [9. 创新点是什么](#9-创新点是什么)
- [10. 如何用于本专业](#10-如何用于本专业)
- [11. 该方案还存在的问题](#11-该方案还存在的问题)
- [12. 注释](#12-注释)

# 1. 综述翻译

我们在哪里可以找到恶意软件源代码？这个问题的动机是一个真正的需求：缺乏恶意软件源代码，这阻碍了各种类型的安全研究。我们的工作受到以下见解的推动：公共档案，如 GitHub，拥有数量惊人的恶意软件存储库。利用这个机会，我们提出了 SourceFinder，这是一种有效识别恶意软件源代码存储库的监督学习方法。我们使用来自 GitHub 的 97K 存储库评估和应用我们的方法。首先，我们展示了我们的方法使用标记数据集以 89% 的准确率和 86% 的召回率识别恶意软件存储库。其次，我们使用 SourceFinder 来识别 7504 个恶意软件源代码存储库，这可以说是最大的恶意软件源代码数据库。最后，我们研究了恶意软件存储库及其作者的基本属性和趋势。此类存储库的数量似乎每 4 年增加一个数量级，并且 18 位恶意软件作者似乎是具有良好在线声誉的“专业人士”。我们认为我们的方法和我们的大型恶意软件源代码存储库可以研究的催化剂，目前是不可能的。

## 1.1 发表于

2020 USENIX

# 2. Tag

# 3. 任务描述

# 4. 方法

我们打算将我们的数据集和工具用于研究目的。我们的愿景是创建社区驱动的参考中心，它将提供：(a) 恶意软件源代码存储库，(b) 社区审查的标签和反馈，以及 (c) 用于收集和分析恶意软件存储库的开源工具。我们的目标是用更多的软件档案扩展我们的数据库。尽管作者可以开始隐藏他们的存储库（见第 8 节），但我们认为我们已经检索到的数据库可能会对某些类型的研究产生重大影响。


GitHub 中的存储库具有以下数据字段：a) 标题，b) 描述，c) 主题，d) README 文件，e) 文件和文件夹，f) 创建日期和最后修改日期，g) 分支，h) 观察者， i) 明星，以及 j) 关注者和关注者，

建立基本事实：由于没有可用的基本事实，我们需要建立自己的。由于这是一项相当技术性的任务，我们选择了领域专家，而不是根据最近的研究 [22] 推荐的 Mechanical Turk 用户。我们使用三位计算机科学家从我们的每个数据集 RD137 和 RD50 以及来自 RD1 的 600 个存储库中手动标记 1000 个存储库，这些存储库是我们以均匀随机方式选择的。评委被指示对每个存储库进行彻底的独立调查。确保地面实况的质量。为了提高地面实况的可靠性，我们采取了以下措施。首先，我们要求法官仅在确定存储库是恶意的或良性且独特的情况下才对其进行标记，否则不对其进行标记。我们只保留法官一致同意的存储库。其次，通过手动检查删除重复的存储库，并从最终标记的数据集中排除以避免过度拟合。值得注意的是，我们在每个具有数百个存储库的数据集中仅发现了 3-5 个数量级的极少数重复项。通过这个过程，我们从每个查询的相应恶意软件存储库开始，建立了三个独立的标记数据集，分别命名为 LD137、LD50 和 LD1，如表 2 所示。虽然标记数据集不是 50-50，但它们代表了两个类相当不错，因此将所有内容标记为一个类的幼稚解决方案的性能会很差。相比之下，我们的方法表现得足够好，正如我们将在第 5 节中看到的。由于没有可用的数据集，我们认为我们通过手动努力制作了足够大小的数据集。

Amazon Mechanical Turk：亚马逊众包网站，雇佣远程众包工作者来执行计算机无法完成的离散任务。

步骤 1. 数据预处理：与任何自然语言处理 (NLP) 方法一样，我们从文本的一些初始处理开始，以提高解决方案的有效性。

  a. 字符级预处理：我们通过删除特殊字符（例如标点符号和货币符号）来处理字符级“噪音”，并修复 Unicode 和其他编码问题。
  b. 字级预处理：我们按照以下最佳实践消除或聚合字词自然语言处理[32]。首先，我们删除文章词和其他本身不具有重要意义的词。其次，我们使用词干技术处理屈折词。即我们希望降低数据的维数通过将具有相同“root”的单词分组。例如，我们将“organizing”、“organized”、“organize”和“organizes”这些词组合为一个词“organize”。第三，我们过滤掉常见的文件和文件夹名称我们不希望对我们的分类有帮助，例如“LEGAL”、“LICENSE”、“gitattributes”等。
  c. 实体级过滤：我们过滤可能对描述存储库范围没有帮助的实体。具体来说，我们删除号码、URL 和电子邮件，这在文中经常出现。我们发现这种过滤提高了分类性能。未来，我们可以考虑挖掘 URL 和其他信息，例如人名、公司或 YouTube 频道的名称，以识别作者、验证意图并发现更多恶意软件活动。

步骤 2. 存储库字段：我们考虑存储库中可以是数字或文本的字段。基于文本的字段需要处理才能将它们转换为分类特征，我们将在下面解释这一点。我们使用并评估以下文本字段：标题、描述、主题、文件和文件夹名称以及自述文件字段。文本字段表示：我们考虑两种技术来通过分类中的特征来表示每个文本字段。

  a. Bag ofWords (BoW)：词袋 (BoW) 模型是最广泛使用的文档表示之一。文档表示为其单词出现的次数，不考虑语法和词序 [69]。该模型通常用于文档分类，其中每个单词的频率用作训练分类器的特征值 [41]。我们使用带有计数向量化器和 TF-IDF 向量化器的模型来创建特征向量。
  b. 词嵌入：词嵌入模型是文档中每个词的向量表示：每个词映射到实数的 M 维向量 [43]，或者等效地投影到 M 维空间中。 良好的嵌入可确保含义接近的单词在嵌入空间中具有附近的表示。 为了创建文档向量，词嵌入遵循两种方法（i）基于频率的向量化器（无监督）[55]和（ii）基于内容的向量化器（监督）[37]。

步骤 3. 选择字段：另一个关键问题是在我们的分类中使用存储库中的哪些字段。 我们对第 2 节中列出的所有领域进行试验，并在下一节中解释我们的发现。

步骤 4. 选择 ML 引擎：我们设计分类器将存储库分为两类：(i) 恶意软件存储库和 (ii) 良性存储库。 我们系统地评估了许多机器学习算法 [7,44]：朴素贝叶斯 (NB)、逻辑回归 (LR)、决策树 (CART)、随机森林 (RF)、K-最近邻 (KNN)、线性判别分析 (LDA) ) 和支持向量机 (SVM)。

步骤 5. 检测源代码存储库：我们还想确定存储库中是否存在源代码，作为向社区提供恶意软件源代码的最后一步。

  我们提出了一种启发式方法，它在实践中似乎效果很好。 首先，我们要识别存储库中包含源代码的文件。 为此，我们首先检查它们的文件扩展名。 如果文件扩展名是已知的编程语言之一：Assembly、C/C++、Batch 他已知的编程语言：Assembly、C/C++、Batch File、Bash Shell Script、Power Shell 脚本、Java、Python、C#、Objective-C 、Pascal、Visual Basic、Matlab、PHP、Javascript 和 Go，我们将其标记为源文件。 其次，如果存储库中的源文件数量超过源百分比阈值（SourceThresh），我们认为存储库包含源代码。

# 5. 解决了什么问题（贡献）

难点：
(a) 从可能庞大的档案中收集一组适当的存储库，
(b) 识别包含恶意软件的存储库。

首先，几项研究分析了软件存储库以查找使用和限制，而没有任何关注恶意软件 [14]。 其次，一些努力维护恶意软件二进制文件的数据库，但没有源代码 [2, 3]。 第三，许多努力试图从二进制文件中提取更高级别的信息，例如提升到中间表示（IR）[19]，但是重新创建源代码真的很困难 [10]。 事实上，此类研究将受益于我们的恶意软件源代码档案，以评估和改进他们的方法。 从软件工程的角度来看，一项有趣的工作 [8] 将 150 个恶意软件源代码存储库的演变与良性软件的演变进行了比较。

贡献：
(a) 我们提出了 SourceFinder，这是一种以高精度识别恶意软件源代码存储库的系统方法，
(b) 我们创建了可以说是最大的非商业恶意软件源代码存档，拥有 7504 个存储库， 
(c) 我们研究存储库生态系统的模式和趋势，包括时间和以作者为中心的属性和行为。

我们确定多产和有影响力的作者。我们发现 3% 的作者拥有超过 300 名粉丝。我们还发现 0.2% 的作者拥有超过 7 个恶意软件存储库，其中最多产的网络威胁作者创建了 336 个存储库。 G。我们识别并分析了 18 名专业黑客。我们发现了 18 位恶意软件存储库的作者，他们似乎围绕他们的活动创建了一个品牌，因为他们在安全论坛中使用相同的用户名。例如，用户 3vilp4wn（发音为 evil-pawn）是 GitHub 中键盘记录恶意软件的作者，作者使用相同的用户名在 Hack This Site 论坛中推广该恶意软件


# 6. 实验结果

正如我们在第 5 节中讨论的那样。我们表明我们分类恶意软件存储库使用存储库中的五个字段，具有 89% 的准确率、86% 的召回率和 87% 的 F1 分数

总结：通过文档判断是否是恶意代码，虽然包含了恶意代码的库，但是并没有具体哪个地方是恶意代码的标签。
# 7. 如何想到该方法

# 8. 我能否想到该方法

# 9. 创新点是什么

# 10. 如何用于本专业

# 11. 该方案还存在的问题

# 12. 注释
