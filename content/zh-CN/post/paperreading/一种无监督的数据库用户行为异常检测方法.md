---
title: "一种无监督的数据库用户行为异常检测方法"
date: 2021-09-15T15:45:46+08:00
tags : [
    "论文阅读笔记",
    "异常行为分析",
]
categories : [
    "论文阅读笔记",
]
series : []
aliases : []
draft: false
math: true
---

# 目录： <!-- omit in toc -->
- [1. 综述翻译](#1-综述翻译)
- [2. Tag](#2-tag)
- [3. 任务描述](#3-任务描述)
- [4. 方法](#4-方法)
  - [概述](#概述)
  - [定义](#定义)
  - [方法](#方法)
- [5. 解决了什么问题（贡献）](#5-解决了什么问题贡献)
- [6. 实验结果](#6-实验结果)
- [7. 如何想到该方法](#7-如何想到该方法)
- [8. 我能否想到该方法](#8-我能否想到该方法)
- [9. 创新点是什么](#9-创新点是什么)
- [10. 如何用于本专业](#10-如何用于本专业)
- [11. 该方案还存在的问题](#11-该方案还存在的问题)
- [12. 注释](#12-注释)

# 1. 综述翻译

User Behavior Anomaly Detection for Database Based on Unsupervised Learning

B刊

检测数据库内部合法用户的异常行为，对防范内部攻击和数据泄露具有重要意义，然而面临如下挑战：攻击模式不确定，真实异常样例少，数据集缺少准确标注。人工设定值和规则难以有效应对复杂多样的异常。本文提出了一种基于无监督学习的用户行为异常检测方法，通过划定时间窗口统计提取特征，运用核密度估计算法分别从单维度、多维度建模，实现在海量的无标注历史日志中发现简单异常和复杂异常、在新的缆上数据中检测异常。真实数据实验表明，该方法能够有效检测出简单异常，实验中检测三种简单异常的平均严格查准率和宽松查准率分别达90%和100%;能够从多维度找出存在攻击嫌疑的复杂异常，实验中成功检测出了一种单维度无法检测出的新的复杂异常

# 2. Tag

数据库; 异常行为检测; 

malicious activites

数据库异常检测

数据库用户异常行为检测

数据库 用户行为检测

待看：https://wap.cnki.net/touch/web/Dissertation/Article/10286-1018037812.nh.html

无监督 行为预测

接下来的调研目标，分一部分到无监督算法。
# 3. 任务描述

对数据库用户行为建模、检测异常

# 4. 方法

## 概述
1. 使用特征工程从原始日志中提取特征。
2. 采用核密度估计算法从单维度、多维度训练得到某个用户正常行为的概率密度模型。计算合理的概率密度阈值
3. 根据样本呢的概率密度是否低于阈值判断该样本是否偏离用户绝大多数正常行为的离群点，从而发出警告。

## 定义
本文将数据库用户行为“异常”定义如下：当用户的操作
行为严重偏离其绝大多数正常历史行为的轨迹时，或者当用
户的操作行为具有拖取数据滥用数据等攻击嫌疑，对数据库
的安全构成威胁时，称为“异常”

简单(单维度)异常:观察单个指标，确定其为异常
复杂异常：需要多个指标组合起来分析，发现其异常之处。

可疑异常率：历史数据中，异常样本占比例。

## 方法

1. 特征提取
   1. 用户角色
   2. 用户工作状态
   3. 用户发器访问位置 天
   4. 访问数据量  天、两小时
   5. 访问不同表总个数  天、两小时
   6. 发器鉴权请求失败比例  天、两小时
   7. 访问绝密级列比例  天、两小时
   8. ![abnoramlBehavior](/researchPng/research/abnoramlBehavior.png)
2. 操作行为的统计特征
   1. 将用户执行的query语句按照时间窗口聚合。
3. 方法：
   1. 对对每一个维度分别归一化。
   2. 核密度估计
      1. 分布概率密度函数f的估值
         1. $f_b(x)=\frac{1}{n}\sum_{i=1}^nK_b(x-x_i)=\frac{1}{nb}\sum_{i=1}^{n}K(\frac{x-x_i}{b})$
         2. 其中K为核函数，是积分值为1的非负函数；b为带宽，是一个平滑参数。核密度估计算法可以简单地理解为将每个样本作为中心点对应的核函数的加权求和
   3. 超参自动搜索模块：GridSearchCV
   4. 概率密度判定阈值$S_0$，可以根据可疑异常率a求出。若假定数据库历史数据中只有1%出现某种简单异常，计算所有历史样本在改维度概率密度值并作升序排列，在1%后的样本即为简单异常。触发相应单维度异常告警。
   5. 多维度概率密度模型
      1. 当选取的m个特征之间相互独立时，样本的整体概率密度等于各个维度的概率密度值相乘。

# 5. 解决了什么问题（贡献）

# 6. 实验结果

# 7. 如何想到该方法

# 8. 我能否想到该方法

# 9. 创新点是什么

# 10. 如何用于本专业

# 11. 该方案还存在的问题

# 12. 注释

相关工作：

1. 基于参考阈值的方法
2. 基于关联规则挖掘的方法
3. 基于免疫原理的方法
4. 基于隐Markov的方法
5. 基于聚类的方法
6. 基于模式挖掘的方法
7. 基于query语句向量化特征的方法
8. 基于数据库应用层检测的方法